{"files":[{"id":"ab975719-8b14-42d6-8c40-7be9a637af20","name":"time","type":"server_js","source":"/** Attempts to insert given @text at the cursor position.*/ \nfunction insert_ ( text )  {\n  var cursor \u003d DocumentApp . getActiveDocument ( ) . getCursor ( ) ;\n  if ( cursor ) {\n    \n    // Attempt to insert text at the cursor position. If insertion returns null,\n    // then the cursor\u0027s containing element doesn\u0027t allow text insertions.\n    var element \u003d cursor . insertText ( text )\n    if ( element ) {\n        element . setFontFamily ( \"Consolas\" ) ; \n        element . setFontSize ( 10 ) ; \n    } \n    else {\n       DocumentApp\n      . getUi ( ) \n      . alert ( \u0027Cannot insert text at this cursor location.\u0027 ) ;\n    }\n  } \n  else {\n      DocumentApp\n      . getUi ( )\n      . alert ( \u0027Cannot find a cursor in the document.\u0027 ) ;\n  }\n}\n\n/** Attempts to insert a Time Stamp with the format \"hh:mm\" at the cursor position.*/ \nfunction insertTimeStamp ( )  {\n  insert_ ( timeStamp_ ( ) ) ; \n}\n\n/** Attempts to insert a Date Stamp with the format \"dd/mm/yyyy\" at the cursor position.*/ \nfunction insertDateStamp ( ) { \n  insert_ ( dateStamp_ ( ) ) ; \n}\n\n/** Attempts to insert a DateTime Stamp with the format \"hh:mm dd/mm/yyyy\" at the cursor position.*/ \n\nfunction insertDateTimeStamp ( ) {\n  insert_ ( dateTimeStamp_ ( ) ) ; \n}\n\n\n/** Returns a Time Stamp with the format \"hh:mm\" */\nfunction timeStamp_ ( ) {  \n  // Create a date object with the current time.\n  var now \u003d new Date ( ) ;\n\n  // Create an array with the current hour \u0026 minute.\n  var time \u003d [ \n    pad_ ( now . getHours   ( ) , 2 ) , \n    pad_ ( now . getMinutes ( ) , 2 ) \n  ] ;\n\n  return time . join ( \":\" ) ;\n}\n\n/** Returns a Date Stamp with the format \"dd/mm/yyyy\" */\nfunction dateStamp_ ( ) {\n\n  // Create a date object with the current time.\n  var now \u003d new Date ( ) ;  \n  \n  // Create an array with the current day, month, \u0026 year.\n  var date \u003d [ \n    pad_ ( now . getDate  ( )     , 2 ) , \n    pad_ ( now . getMonth ( ) + 1 , 2 ) , \n    now . getFullYear ( )  \n  ];\n  \n  return date . join ( \"/\" ) ;  \n  // more concise with:   return [ array elements ] .join (\"/\") ; \n  \n}\n/** Returns a DateTime Stamp with the format \"hh:mm dd/mm/yyyy\" */\nfunction dateTimeStamp_ ( ) {\n  return timeStamp_ ( ) + \" \" + dateStamp_ ( ) ; \n}\n\n/** pads @str with zeros if it\u0027s length is less than @max */ \nfunction pad_ ( str , max ) {\n  str \u003d str . toString ( ) ;\n  return str . length \u003c max ? pad_ ( \"0\" + str , max) : str ;\n}\n\n\n\n"},{"id":"b0e2c2a2-9c9f-4ab7-802b-39113bd40caf","name":"init","type":"server_js","source":"/** Adds a buttons to google docs UI so that you can access the functions*/ \nfunction onOpen ( ) \n{\n  var ui \u003d DocumentApp . getUi ( ) ; \n  var projectName \u003d \u0027MyScripts.\u0027\n  \n  \n  // create a \"MyScripts Menu, and add it to the \"user interface\" bar. \n  var menu_myScripts \u003d ui . createMenu ( \"MyScripts\" ) ;  \n\n    // create an \"Insert\" menu.\n    var menu_insert    \u003d ui . createMenu ( \"Insert\" ) ; \n    \n      // create a \"Date \u0026 Time\" menu. \n      var menu_time \u003d ui. createMenu ( \"Date \u0026 Time\" ) ; \n      \n        // add links to \"date \u0026 time functions\" in the \"Date \u0026 Time\" menu. \n        menu_time \n        . addItem ( \u0027hh:mm dd/mm/yyyy\u0027 , projectName + \u0027insertDateTimeStamp\u0027 )\n        . addItem ( \u0027dd/mm/yyyy\u0027       , projectName + \u0027insertDateStamp\u0027     )\n        . addItem ( \u0027hh:mm\u0027            , projectName + \u0027insertTimeStamp\u0027     ) ; \n      \n      // create a \"Signature\" menu. \n      var menu_signature \u003d ui . createMenu ( \"Signature\" ) ; \n      \n        // add links to \"signature functions\" in the Signature menu. \n        menu_signature \n        . addItem ( \u0027#fawby\u0027 , projectName + \u0027onOpen\u0027 ) ; \n          \n      // add \"Date \u0026 Time\" menu to the \"Insert\" menu.\n      menu_insert . addSubMenu ( menu_time ) ;    \n\n      // add \"Signature\" menu to the \"Insert\" menu. \n      menu_insert . addSubMenu ( menu_signature ) ;         \n              \n    // add \"Insert\" menu to the \"MyScripts\" menu.  \n    menu_myScripts . addSubMenu ( menu_insert  ) ;   \n     \n  // add \"MyScripts Menu to the \"user interface\" bar.    \n  menu_myScripts . addToUi ( ) ; \n        \n        \n}\n"}]}